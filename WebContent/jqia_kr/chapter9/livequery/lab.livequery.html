<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Live Query 연습</title>
    <link rel="stylesheet" type="text/css" href="../../common.css">
    <script type="text/javascript" src="../../scripts/jquery-1.2.1.js"></script>
    <script type="text/javascript" src="../../scripts/jquery.livequery.js"></script>
    <script type="text/javascript">
      var count = 1;
      $(function(){
        $('div.testSubject').livequery('click',
          function(){
            $(this).toggleClass('matched');
          }
        );
        $('div.matched').livequery(
          function(){ reportMatch(this,true); },
          function(){ reportMatch(this,false); }
        );
        $('#addButton').click(function(){
          count++;
          $('<div id="testSubject'+count+'" class="testSubject">테스트 대상 '+count+'</div>').appendTo('#testSubjects');
          $('#console').append(
            '<div>엘리먼트 DIV#testSubject'+count+'이(가) 추가되었습니다.</div>'
          );

        });
        $('#expireEventButton').click(function(){
          $('div.testSubject').expire();
        });
        $('#expireMatchButton').click(function(){
          $('div.matched').expire();
        });
      });

      function reportMatch(element,matched) {
        $('#console').append(
          '<div>엘리먼트 '+element.tagName+'#'+element.id+' 이(가)'+(matched?'일치되었습니다.':'불일치되었습니다.')+'</div>'
        );
      }
    </script>
    <style>
      fieldset {
        width: 360px;
      }
      .testSubject {
        border: 2px solid black;
        background-color: white;
        padding: 8px;
      }
      .matched {
        border: 4px solid maroon;
        background-color: khaki;
      }
      button {
        width: 200px;
      }
    </style>
  </head>

  <body>
    <h1>Live Query 연습</h1>
    <fieldset>
      <legend>제어 패널</legend>
      <div>
        <button type="button" id="addButton">새로운 테스트 대상 추가하기</button><br/>
        <button type="button" id="expireMatchButton">일치 핸들러 제거하기</button>
        <button type="button" id="expireEventButton">이벤트 핸들러 제거하기</button><br/>
      </div>
    </fieldset>

    <fieldset>
      <legend>테스트 대상</legend>
      <div id="testSubjects">
        <div class="testSubject" id="testSubject1">테스트 대상 1</div>
      </div>
    </fieldset>

    <fieldset>
      <legend>콘솔</legend>
      <div id="console"></div>
    </fieldset>
  </body>
</html>
